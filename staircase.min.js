/* Staircase | Version 5.0.0 538a | Â© Zeta Interactive 2013 - 2015 */
;(function(){String.prototype.trim=function(a){var b=this,c,l=0,i=0;b+='';if(!a){c=' \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000'}else{a+='';c=a.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,'$1')}l=b.length;for(i=0;i<l;i++){if(c.indexOf(b.charAt(i))===-1){b=b.substring(i);break}}l=b.length;for(i=l-1;i>=0;i--){if(c.indexOf(b.charAt(i))===-1){b=b.substring(0,i+1);break}}return c.indexOf(b.charAt(0))===-1?b:''};String.prototype.hash=function(c){var a='',b='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789<>!:;,.$';c=c?c:8;for(var i=0;i<c;i++)a+=b.charAt(Math.floor(Math.random()*b.length));return a};Number.prototype.toDate=function date(k){var d,a,h="Sun Mon Tues Wednes Thurs Fri Satur January February March April May June July August September October November December".split(" "),f=/\\?(.?)/gi,g=function(b,c){return a[b]?a[b]():c},e=function(b,a){for(b=String(b);b.length<a;)b="0"+b;return b};a={d:function(){return e(a.j(),2)},D:function(){return a.l().slice(0,3)},j:function(){return d.getDate()},l:function(){return h[a.w()]+"day"},N:function(){return a.w()||7},S:function(){var b=a.j(),c=b%10;3>=c&&1==parseInt(b%100/10,10)&&(c=0);return["st","nd","rd"][c-1]||"th"},w:function(){return d.getDay()},z:function(){var b=new Date(a.Y(),a.n()-1,a.j()),c=new Date(a.Y(),0,1);return Math.round((b-c)/864E5)},W:function(){var b=new Date(a.Y(),a.n()-1,a.j()-a.N()+3),c=new Date(b.getFullYear(),0,4);return e(1+Math.round((b-c)/864E5/7),2)},F:function(){return h[6+a.n()]},m:function(){return e(a.n(),2)},M:function(){return a.F().slice(0,3)},n:function(){return d.getMonth()+1},t:function(){return(new Date(a.Y(),a.n(),0)).getDate()},L:function(){var b=a.Y();return 0===b%4&0!==b%100|0===b%400},o:function(){var b=a.n(),c=a.W();return a.Y()+(12===b&&9>c?1:1===b&&9<c?-1:0)},Y:function(){return d.getFullYear()},y:function(){return a.Y().toString().slice(-2)},a:function(){return 11<d.getHours()?"pm":"am"},A:function(){return a.a().toUpperCase()},B:function(){var a=3600*d.getUTCHours(),c=60*d.getUTCMinutes(),f=d.getUTCSeconds();return e(Math.floor((a+c+f+3600)/86.4)%1E3,3)},g:function(){return a.G()%12||12},G:function(){return d.getHours()},h:function(){return e(a.g(),2)},H:function(){return e(a.G(),2)},i:function(){return e(d.getMinutes(),2)},s:function(){return e(d.getSeconds(),2)},u:function(){return e(1E3*d.getMilliseconds(),6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)";},I:function(){var b=new Date(a.Y(),0),c=Date.UTC(a.Y(),0),d=new Date(a.Y(),6),e=Date.UTC(a.Y(),6);return b-c!==d-e?1:0},O:function(){var a=d.getTimezoneOffset(),c=Math.abs(a);return(0<a?"-":"+")+e(100*Math.floor(c/60)+c%60,4)},P:function(){var b=a.O();return b.substr(0,3)+":"+b.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-d.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(f,g)},r:function(){return"D, d M Y H:i:s O".replace(f,g)},U:function(){return d/1E3|0}};return function(a,c){d=void 0===c?new Date:c instanceof Date?new Date(c):new Date(1E3*c);return a.replace(f,g)}(k,this)};try{window.location.param=function(n,u){if(!u)var u=window.location.search;var a=RegExp('[?&](?:amp;)?'+(n.replace(/(\[|\]|\{|\}|\?|\/|\\|\||\(|\))/g,'\\$1'))+'=([^&]*)').exec(u);return a&&decodeURIComponent(a[1].replace(/\+/g,' '))};Object.defineProperty(window.location,'params',{set:function(){},get:function(){var a={},b=window.location.search.substr(1).split('&');if(b)for(var i in b){b[i]=b[i].replace(/^(?:amp;)?([^=]+)=(.*)?$/,'$1\n$2').split('\n');if(a[b[i][0]]){a[b[i][0]]=[a[b[i][0]]];a[b[i][0]].push(b[i][1])}else a[b[i][0]]=b[i][1]}return a}})}catch(e){if(window.console)console.error('Your browser does not support changes to window.location.',e)}window.jQuery.fn.staircase=function(a){var $=window.jQuery;if($(this).length==1&&$(this).data('staircase'))return $(this).data('staircase');else return $(this).each(function(){$(this).data('staircase',new Staircase(this,a?a:{}))})};window.jQuery('input[staircase-value]').each(function(){var $=window.jQuery,fillstr=$(this).attr('staircase-value').replace(/#{(.*?)}/g,function(m,a){if(a.match(/^date\.(.*)$/i))return(new Date/1000).toDate(a.replace(/^date\.(.*)$/i,'$1'));else if(a.match(/^cookies?\.(.*)$/i)){var b=a.replace(/^cookies?\.(.*)$/i,'$1'),cookies=document.cookie.split('; ');for(var i in cookies)if(cookies[i].split('=')[0]==b)return cookies[i].substr(b.length+1);return''}else{a=a.split('.');var c=window;for(var i in a)if(c[a[i]])c=c[a[i]];else return undefined;if(c!=window)return c}});$(this).removeAttr('staircase-value').val(fillstr)});if(!document.title||$('head title').length==0){var o=$('h1, h2, h3, h4, h5, h6').first().text();if(!o)o=$('img[alt]').first().attr('alt');if(!o)o=($('p').first().text().trim()||'').split(' ').slice(0,4).join(' ');if(!o)o=($('body').text().trim()||'').split(' ').slice(0,4).join(' ');if(!o)o=window.location.href.replace(/^(?:f|ht)tps?:\/\/(.*?)\.((com?|org|net|gov|edu)(\.uk)?|info)(\/(.*)?)?$/i,'$1').replace(/(-|\.|)/g,' ').replace(/(^| )([a-z])/g,function(m,a,b){return a+(b.toUpperCase())});if(!o)o=window.location.pathname.substr(1);document.title=o}window.Staircases={};window.Staircase=function(k,l){var $=window.jQuery,$this=$(k),$staircase=this,$scrollTop=0,$options={checkboxGroups:false,history:false,ID:''.hash(8),notifyDelay:3,steps:'.step',stepBlur:null,stepFocus:null,validate:null},sandbox=function(a){return a};if(l&&typeof l=='object')for(var i in l)$options[i]=l[i];$staircase.Patterns={currency:/^(-)?([^a-zA-Z0-9 ])?([0-9\,]+)(\.([0-9]{2,}))?$/,date:[/^([0-9]{1,2})(\/|-|\.|,| )([0-9]{1,2})(\/|-|\.|,| )([0-9]{2,4})$/,/^((mon|monday|tue|tues|tuesday|wed|wednesday|thu|thurs|thursday|fri|friday|sat|saturday|sun|sunday)([\s]+))?([0-9]{1,2})(st|nd|rd|th)?([\s]+)?(jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|sept|september|oct|october|nov|november|dec|december)([\s]+)?([0-9]{2,4})$/i],datepicker:/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/,'default':/^(?!\s*$).+/,email:/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,filename:/^(([^\/\\\?%\*:|"<>]+)?\.([^\/\\\?%\*:|"<>\.]+)|([^\/\\\?%\*:|"<>\.]+))$/,name:/^([ A-Za-z\.']+)$/,number:[/^(-)?([0-9]+)$/,/^(-)?([0-9]+)\.([0-9]+)$/],phone:[/^(\+([0-9]{1,5})|0)(?!.*(\d)\1{9,})\d{9,}$/,/^(\+([0-9]{1,5})|07)(?!.*(\d)\1{9,})\d{9,}$/,/^(\+33|0)(?!.*(\d)\1{9,})\d{9,}$/],postcode:/^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z])))) {0,1}[0-9][A-Za-z]{2})$/,time:/^([0-9]{1,2}):([0-9]{2})(:([0-9]{2}))?([\s]+)?(am|pm)?$/i,zipcode:/^(^\d{5}$)|(^\d{5}-\d{4}$)$/};$staircase.$object=$this;$staircase.$current=0;$staircase.Steps=[];$(window).bind('hashchange popstate',function(){var a=/^#!\/([A-Z0-9<>\!\:\;\,\.\$]{8})\/([0-9]+)$/i;if(window.location.hash.match(/^#!?\/?$/))for(var i in window.Staircases)window.Staircases[i].Steps[0].Focus();else if(window.location.hash.match(a)){var b=window.location.hash.replace(a,'$1'),step=parseInt(window.location.hash.replace(a,'$2'));if(window.Staircases[b]&&window.Staircases[b].Steps[step]&&window.Staircases[b].Steps[step].Quantum)window.Staircases[b].Steps[step].Focus()}$(window).scrollTop($scrollTop)});$staircase.Extend=function(a,b){$staircase.Patterns[a]=b;return $staircase};$staircase.Validate=function(a){var b=a.attr('validate');if(b)if((b=='select'||b=='selected')&&a.is('select')){var c=a.val(),placeholder=a.find('option').first(),placeholderval=(placeholder.attr('value')===undefined)?placeholder.html():placeholder.attr('value');if(typeof c=='object'){for(var i in c)if(c[i]==placeholderval)return!1}if(c==placeholderval)return!1;return!0}else{if((b=='checked'||b=='unchecked')&&(a.attr('type')=='checkbox'||a.attr('type')=='radio'))return!((b=='checked'&&!a.is(':checked'))||(b=='unchecked'&&a.is(':checked')));var d=$staircase.Patterns,key=(b.indexOf('[')>-1)?b.replace(/\[([0-9]+)\]/g,'\n$1').split('\n'):[b];if(d){if(key.length>1){for(var i=0;i<key.length;i++)if(d[key[i]])d=d[key[i]];else break}else{if(typeof d[key[0]]=='object'&&!(d[key[0]]instanceof RegExp))d=d[key[0]][0];else d=d[key[0]]}if(d&&d instanceof RegExp)return!!a[0].value.match(d)}}if($options.validate&&typeof $options.validate=='function')return!!$options.validate.call(a[0],$staircase);return!1};$staircase.Locate=function(a,b){return $.ajax({url:'http://staircase.virtuosoadvertising.co.uk/bin/address-lookup.php',type:'post',dataType:'json',data:{postcode:a},success:function(){if(b&&address&&typeof address=='object'&&address.county&&address.town&&address.street){address.postcode=a;b(address)}}}),$staircase};$staircase.To=function(a){if(a<$staircase.$current)$staircase.Steps[a].Focus();else if($staircase.Steps[a]&&$staircase.Steps[$staircase.$current].Validate())$staircase.Steps[a].Focus();return $staircase};$staircase.Next=function(){if($staircase.Steps[$staircase.$current+1]&&$staircase.Steps[$staircase.$current].Validate())$staircase.Steps[$staircase.$current+1].Focus();return $staircase};$staircase.Prev=function(){if($staircase.Steps[$staircase.$current-1])$staircase.Steps[$staircase.$current-1].Focus();return $staircase};var m=function(){var h=$(arguments[0]),$step=this,$qstate=null;$allinputs='input:not([type="button"], [type="submit"], [type="image"])[name], select[name], textarea[name]',$inputs='input:not([type="button"], [type="submit"], [type="image"])[validate], select[validate], textarea[validate]',$buttons='input[type="button"].next, input[type="button"].continue, input[type="button"].submit, input[type="submit"], button',$backbuttons='input[type="button"].prev, input[type="submit"].prev, button.prev, input[type="button"].back, input[type="submit"].back, button.back';$step.$index=arguments[1];$step.$object=h;$step.$rules=[];Object.defineProperty($step,'Quantum',{set:function(){},get:function(){return $qstate}});$step.Focus=function(a){for(var i in $staircase.Steps)$staircase.Steps[i].Blur(a);if(!h.is(':visible')){$staircase.$current=$step.$index;if(!$qstate)$qstate=new Date();if(!a)h.trigger('focus');h.show();var b='!/'+$options.ID+'/'+$step.$index;$scrollTop=$(window).scrollTop();if($step.$index>0&&window.location.hash!='#'+b)location.hash=b;else if($step.$index==0)location.hash='!/'}return $step};$step.Blur=function(a){if(h.is(':visible')){if(!a)h.trigger('blur');h.hide()}return $step};$step.Validate=function(a){if(!a){var b=!0;h.find($inputs).each(function(){if(!$step.Validate(this))b=!1});return b}a=$(a);var c=!!$staircase.Validate(a),label=a.closest('label').length?a.closest('label'):((a.attr('id')&&$('label[for="'+a.attr('id')+'"]').length)?$('label[for="'+a.attr('id')+'"]'):false),apply=$(label?label.add(a):a);if(!c){apply.addClass('staircase-has-error staircase-highlight-error');apply.data('notify-timeout',setTimeout(function(){apply.removeClass('staircase-highlight-error')},$options.notifyDelay>30?$options.notifyDelay:($options.notifyDelay*1000)));return!1}else{apply.removeClass('staircase-has-error staircase-highlight-error');if(apply.data('notify-timeout'))window.clearTimeout(apply.data('notify-timeout'))}return!0};$step.Condition=function(b){if(typeof b!='function'&&typeof b!='string')return $step;var c=['Staircase','Step','$'],inputs={};h.find('input:not([type="button"], [type="submit"], [type="image"])[name], textarea[name], select[name]').each(function(){var a=$(this).attr('name');if(inputs[a]){inputs[a]=[inputs[a]];inputs[a].push(this)}else{c.push(a);inputs[a]=this}});$step.$rules.push({callback:(typeof b=='function')?b:new Function(c,b),inputs:inputs});return $step};h.find($inputs).bind('change blur validate',function(){$step.Validate(this)});h.find($backbuttons).not($buttons).bind('click',function(){if($step.$index>0)$staircase.Steps[$step.$index-1].Focus();return!1});h.find($buttons).not($backbuttons).bind('click',function(){h.find($inputs).trigger('validate');if($options.checkboxGroups){var c=(typeof $options.checkboxGroups=='string')?h.find($options.checkboxGroups):((h.find('.checkbox-group').length)>0?h.find('.checkbox-group'):h);if(c.find('input:not([type="button"], [type="submit"], [type="image"]), select, textbox').length==c.find('input[type="checkbox"]').length){if(c.find('input[type="checkbox"]:checked').length==0){c.addClass('staircase-has-error staircase-highlight-error');c.data('notify-timeout',setTimeout(function(){c.removeClass('staircase-highlight-error')},$options.notifyDelay>30?$options.notifyDelay:($options.notifyDelay*1000)))}else{c.removeClass('staircase-has-error staircase-highlight-error');if(c.data('notify-timeout'))window.clearTimeout(c.data('notify-timeout'))}}}if(h.hasClass('staircase-has-error')||h.find('.staircase-has-error').length>0)return!1;var d=!0;for(var i in $step.$rules){var e=[sandbox($staircase),sandbox($step),window.jQuery];for(var j in $step.$rules[i].inputs){var f=$($step.$rules[i].inputs[j]);if(f.length>1)f=f.filter(function(){return(($(this).attr('type')=='checkbox'||$(this).attr('type')=='radio')&&!$(this).is(':checked'))?!1:!0});e.push((f.length>0)?(f.length>1?(function(a,b){a.each(function(){b.push($(this)[0].value)});return b})(f,[]):f[0].value):undefined)}if($step.$rules[i].callback.apply(window,e)===false)d=!1}if(!d)return!1;if($staircase.Steps.length>($step.$index+1))return $staircase.Steps[$step.$index+1].Focus(),!1;if(!h.closest('form').length&&window.console){console.log('%cStaircase Submit Event:','font-weight: bold; font-size: 1.2em; color: #333;');console.log('%cYou are seeing this table because no submissible <form> element was found in the DOM.','font-size: .8em;');console.log(' ');var g=[];$($allinputs).each(function(){g.push({Field:$(this).attr('name'),Value:this.value})});if(window.console.table)console.table(g,['Field','Value']);else console.log(g)}});h.find('script[type="staircase/condition"]').each(function(){$step.Condition($(this).html())}).remove();return $step};$this.find($options.steps).each(function(){$staircase.Steps.push(new m(this,arguments[0]).Blur(!0))});$staircase.Steps[0].Focus(!0);window.Staircases[$options.ID]=$staircase;return $staircase}})();